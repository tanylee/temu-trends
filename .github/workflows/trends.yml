# .github/workflows/trends.yml  — фрагменты

# 1) Node без кэша lock-файла
      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: 20
          # cache: npm  # УБРАНО, чтобы не требовался package-lock.json

# 2) Установка зависимостей без lock-файла
      - name: Install deps
        run: |
          npm install --no-audit --no-fund
          npx playwright install --with-deps chromium

# … остальной пайплайн …

# 3) Notify failure (исправленный curl)
      - name: Notify failure
        if: failure()
        run: |
          curl -s -X POST "https://api.telegram.org/bot${{ secrets.TELEGRAM_BOT_TOKEN }}/sendMessage" \
            -d chat_id="${{ secrets.TELEGRAM_CHAT_ID }}" \
            --data-urlencode text="❌ Ошибка в TEMU Trends workflow. Проверь логи Actions."
